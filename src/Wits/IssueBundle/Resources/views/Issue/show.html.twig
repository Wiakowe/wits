{% extends '::base.html.twig' %}

{% set title = issue.name %}

{% block title %}{{ title }} - {{ project.name }}{% endblock %}

{% block body %}

    <div id="issue">
        <h1>{{ title }}</h1>

        <div id="issue_description" class="markdown-text">
            {{  issue.description|markdown }}
        </div>


        {% include 'WitsIssueBundle:Comment/Partial:list.html.twig' %}
    </div>
{% endblock %}

{% block aside %}
    {% if is_granted('ROLE_ISSUE_EDIT') %}
        <a class="btn" href="{{ path('wits_issue_edit', {'project_id': project.id, 'issue_id': issue.id }) }}">{% trans %}label_edit{% endtrans %}</a>
    {% endif %}
    <br />
    {% if is_granted('ROLE_ISSUE_COMMENT') %}
        <a class="btn btn-primary" href="{{ path('wits_comment_create', {'project_id': project.id, 'issue_id': issue.id }) }}">{% trans %}label_comment{% endtrans %}</a>
    {% endif %}
    {% if issue.type %}
        <h4>{% trans %}label_issue_type{% endtrans %}</h4>
        <div class="{{ issue.bootstrapButtonFromType }} priority">{{  issue.typeName|trans }}</div>
    {%  endif  %}
    {% if issue.version %}
        <h4>{% trans %}label_issue_version{% endtrans %}</h4>
        <div class="btn-info priority">{{ issue.version.name }}</div>
    {% endif %}
    {% if issue.creator %}
        <h4>{% trans %}label_issue_creator{% endtrans %}</h4>
        <img src="{{ gravatar(issue.creator.email, 30) }}"/>
        <span>{{  issue.creator }}</span>
    {%  endif  %}
    {% if issue.createdAt %}
        <h4>{% trans %}label_created_at{% endtrans %}</h4>
        <span>{{ issue.createdAt|date('d/m/y h:i:s') }}</span>
    {% endif %}
    {% if issue.updatedAt %}
        <h4>{% trans %}label_updated_at{% endtrans %}</h4>
        <span>{{ issue.updatedAt|date('d/m/y h:i:s') }}</span>
    {% endif %}
    {% if issue.assignee %}
        <h4>{% trans %}label_issue_assignee{% endtrans %}</h4>
        <img src="{{ gravatar(issue.assignee.email, 30) }}"/>
        <span>{{  issue.assignee }}</span>
    {%  endif  %}
    <h4>{%  trans %}label_issue_status{%  endtrans  %}</h4>
    <div class="{{ issue.bootstrapButtonFromStatus }} priority">{{  issue.statusName|trans }}</div>
    {% if issue.estimatedHours %}
        <h4>{% trans %}label_issue_hours_estimated{% endtrans %}</h4>
        <span>{{ issue.estimatedHours }}</span>
    {%  endif  %}
    {% if issue.spentHours %}
        <h4>{% trans %}label_issue_hours_spent{% endtrans %}</h4>
        <span>{{ issue.spentHours }}</span>
    {%  endif  %}
    <br />    
{% endblock %}
